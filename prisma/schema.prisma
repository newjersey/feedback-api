// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

model Feedback {
  id  Int @id @default(autoincrement())
  createdAt DateTime @db.Timestamptz(3) @default(now()) @map("created_at")
  createdAtFromApi DateTime @db.Timestamptz(3) @map("created_at_from_api")
  rating Boolean
  pageUrl String @map("page_url")
  comment String?
  email String?

  /**
    Note: The pageUrl index should use the `text_pattern_ops` operator instead of the default B-tree operator. 
      
    This is because `text_pattern_ops` is better suited to pattern matching expressions. (See PostgreSQL docs: https://www.postgresql.org/docs/current/indexes-opclass.html)
      
    However, we are unable to define this in the Prisma schema because doing so causes endless migrations (see similar GitHub issue: https://github.com/prisma/prisma/issues/17518)

    As a workaround, the init migration with the CREATE TABLE command for the 
    `feedback` table has been manually customized to set the text_pattern_ops operator.

    If you ever regenerate this migration (i.e. while squashing), please make sure to edit the CREATE INDEX command to use the `text_pattern_ops` operator: 

    Example:
    ```
    CREATE INDEX "Feedback_pageUrl_createdAt_idx" ON "Feedback"("pageUrl" text_pattern_ops, "createdAt");
    ```
  **/
  @@index([pageUrl, createdAt])

   @@map("feedback")
}
